<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª - Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #e74c3c;
      --primary-dark: #c0392b;
      --secondary: #3498db;
      --success: #27ae60;
      --warning: #f39c12;
      --dark: #2c3e50;
      --light: #ecf0f1;
      --white: #ffffff;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f8f9fa;
      line-height: 1.6;
    }

    /* HEADER */
    .top-bar {
      background: var(--dark);
      color: white;
      padding: 8px 0;
      font-size: 0.85em;
    }

    .top-bar-content {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
    }

    .top-bar-left, .top-bar-right {
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .top-bar a {
      color: white;
      text-decoration: none;
      transition: color 0.3s;
    }

    .top-bar a:hover {
      color: var(--primary);
    }

    header {
      background: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 30px;
    }

    .logo {
      font-size: 2em;
      font-weight: bold;
      color: var(--primary);
      text-decoration: none;
      white-space: nowrap;
    }

    .search-bar {
      flex: 1;
      max-width: 600px;
      position: relative;
    }

    .search-input {
      width: 100%;
      padding: 12px 50px 12px 20px;
      border: 2px solid #ddd;
      border-radius: 50px;
      font-size: 1em;
      transition: border-color 0.3s;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--primary);
    }

    .search-btn {
      position: absolute;
      left: 5px;
      top: 50%;
      transform: translateY(-50%);
      background: var(--primary);
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 50px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .search-btn:hover {
      background: var(--primary-dark);
    }

    .cart-btn {
      position: relative;
      background: var(--success);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 50px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: background 0.3s;
    }

    .cart-btn:hover {
      background: #229954;
    }

    .cart-count {
      background: white;
      color: var(--success);
      border-radius: 50%;
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8em;
      font-weight: bold;
    }

    /* HERO SECTION */
    .hero {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: 60px 20px;
      text-align: center;
    }

    .hero-content {
      max-width: 1400px;
      margin: 0 auto;
    }

    .hero h1 {
      font-size: 2.8em;
      margin-bottom: 15px;
    }

    .hero p {
      font-size: 1.3em;
      opacity: 0.95;
      margin-bottom: 40px;
    }

    /* CAR SELECTOR */
    .car-selector {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      max-width: 900px;
      margin: -30px auto 0;
      position: relative;
    }

    .selector-title {
      font-size: 1.4em;
      color: var(--dark);
      margin-bottom: 25px;
      text-align: center;
    }

    .selector-steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }

    .step {
      display: flex;
      flex-direction: column;
    }

    .step label {
      font-weight: 600;
      color: var(--dark);
      margin-bottom: 8px;
      font-size: 0.95em;
    }

    .step select {
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1em;
      background: white;
      cursor: pointer;
      transition: all 0.3s;
    }

    .step select:hover {
      border-color: var(--primary);
    }

    .step select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1);
    }

    .step select:disabled {
      background: #f5f5f5;
      cursor: not-allowed;
      opacity: 0.6;
    }

    /* MAIN CONTENT */
    .container {
      max-width: 1400px;
      margin: 40px auto;
      padding: 0 20px;
    }

    .filters-section {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      align-items: center;
    }

    .filter-chip {
      background: var(--light);
      padding: 8px 15px;
      border-radius: 50px;
      font-size: 0.9em;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .filter-chip.active {
      background: var(--primary);
      color: white;
    }

    .results-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .results-count {
      font-size: 1.1em;
      color: var(--dark);
    }

    .sort-select {
      padding: 10px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      background: white;
      cursor: pointer;
    }

    /* PRODUCTS GRID */
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 25px;
    }

    .product-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 15px rgba(0,0,0,0.08);
      transition: all 0.3s;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .product-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background: var(--warning);
      color: white;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.75em;
      font-weight: bold;
      z-index: 10;
    }

    .product-badge.bestseller {
      background: var(--success);
    }

    .product-image-container {
      position: relative;
      height: 220px;
      background: #f8f9fa;
      overflow: hidden;
    }

    .image-slider-wrapper {
      display: flex;
      height: 100%;
      transition: transform 0.4s ease;
    }

    .image-slider-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      padding: 20px;
      flex-shrink: 0;
    }

    .slider-controls {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 6px;
    }

    .slider-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(0,0,0,0.3);
      cursor: pointer;
      transition: all 0.3s;
    }

    .slider-dot.active {
      background: var(--primary);
      width: 20px;
      border-radius: 4px;
    }

    .product-info {
      padding: 20px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .product-name {
      font-size: 1.1em;
      color: var(--dark);
      margin-bottom: 10px;
      font-weight: 600;
      line-height: 1.4;
    }

    .product-ref {
      font-size: 0.85em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .product-rating {
      display: flex;
      align-items: center;
      gap: 5px;
      margin-bottom: 15px;
      font-size: 0.9em;
    }

    .stars {
      color: var(--warning);
    }

    .product-price {
      font-size: 1.8em;
      color: var(--primary);
      font-weight: bold;
      margin-bottom: 15px;
    }

    .price-currency {
      font-size: 0.6em;
      color: #7f8c8d;
    }

    .product-actions {
      display: flex;
      gap: 10px;
      margin-top: auto;
    }

    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 0.95em;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
      flex: 1;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
    }

    .btn-whatsapp {
      background: #25D366;
      color: white;
      flex: 1;
    }

    .btn-whatsapp:hover {
      background: #20BA5A;
    }

    /* EMPTY STATE */
    .empty-state {
      text-align: center;
      padding: 80px 20px;
      background: white;
      border-radius: 12px;
    }

    .empty-state h2 {
      color: var(--dark);
      font-size: 1.8em;
      margin-bottom: 15px;
    }

    .empty-state p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

    /* CART PANEL */
    .cart-panel {
      position: fixed;
      left: -400px;
      top: 0;
      width: 400px;
      height: 100vh;
      background: white;
      box-shadow: 2px 0 20px rgba(0,0,0,0.2);
      transition: left 0.3s;
      z-index: 1000;
      display: flex;
      flex-direction: column;
    }

    .cart-panel.open {
      left: 0;
    }

    .cart-header {
      padding: 20px;
      background: var(--dark);
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cart-close {
      background: none;
      border: none;
      color: white;
      font-size: 1.5em;
      cursor: pointer;
    }

    .cart-items {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
    }

    .cart-item {
      display: flex;
      gap: 15px;
      padding: 15px;
      border-bottom: 1px solid #eee;
    }

    .cart-item-image {
      width: 70px;
      height: 70px;
      object-fit: contain;
      background: #f8f9fa;
      border-radius: 8px;
      padding: 5px;
    }

    .cart-item-info {
      flex: 1;
    }

    .cart-item-name {
      font-weight: 600;
      color: var(--dark);
      margin-bottom: 5px;
    }

    .cart-item-price {
      color: var(--primary);
      font-weight: bold;
    }

    .cart-item-remove {
      background: none;
      border: none;
      color: #e74c3c;
      cursor: pointer;
      font-size: 1.2em;
    }

    .cart-footer {
      padding: 20px;
      border-top: 2px solid #eee;
    }

    .cart-total {
      display: flex;
      justify-content: space-between;
      font-size: 1.3em;
      font-weight: bold;
      margin-bottom: 15px;
    }

    .cart-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 999;
      display: none;
    }

    .cart-overlay.open {
      display: block;
    }

    @media (max-width: 768px) {
      .header-content {
        flex-wrap: wrap;
      }

      .search-bar {
        order: 3;
        max-width: 100%;
      }

      .hero h1 {
        font-size: 2em;
      }

      .selector-steps {
        grid-template-columns: 1fr;
      }

      .cart-panel {
        width: 100%;
        left: -100%;
      }

      .products-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      }
    }
  </style>
</head>
<body>
  <!-- TOP BAR -->
  <div class="top-bar">
    <div class="top-bar-content">
      <div class="top-bar-left">
        <span>ğŸ“ 0770 XX XX XX</span>
        <span>ğŸ‡©ğŸ‡¿ Ø§Ù„ØªÙˆØµÙŠÙ„ Ù„Ø¬Ù…ÙŠØ¹ ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</span>
      </div>
      <div class="top-bar-right">
        <a href="#">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
        <a href="#">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</a>
      </div>
    </div>
  </div>

  <!-- HEADER -->
  <header>
    <div class="header-content">
      <a href="#" class="logo">ğŸš— AUTO PARTS DZ</a>
      
      <div class="search-bar">
        <input type="text" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‚Ø·Ø¹Ø© Ù…Ø¹ÙŠÙ†Ø© Ø£Ùˆ Ø±Ù‚Ù… Ù…Ø±Ø¬Ø¹ÙŠ...">
        <button class="search-btn">Ø¨Ø­Ø«</button>
      </div>

      <button class="cart-btn" onclick="toggleCart()">
        <span>ğŸ›’</span>
        <span class="cart-count" id="cartCount">0</span>
        <span>Ø§Ù„Ø³Ù„Ø©</span>
      </button>
    </div>
  </header>

  <!-- HERO SECTION -->
  <div class="hero">
    <div class="hero-content">
      <h1>Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø£ØµÙ„ÙŠØ© Ù„Ø³ÙŠØ§Ø±ØªÙƒ</h1>
      <p>Ø£ÙƒØ«Ø± Ù…Ù† 50,000 Ù‚Ø·Ø¹Ø© Ù…ØªÙˆÙØ±Ø© â€¢ Ø£Ø³Ø¹Ø§Ø± Ù…Ù†Ø§ÙØ³Ø© â€¢ ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹</p>
      
      <!-- CAR SELECTOR -->
      <div class="car-selector">
        <h2 class="selector-title">Ø­Ø¯Ø¯ Ø³ÙŠØ§Ø±ØªÙƒ Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù‚Ø·Ø¹ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</h2>
        <div class="selector-steps">
          <div class="step">
            <label>Ø§Ù„Ø´Ø±ÙƒØ©</label>
            <select id="brandSelect">
              <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ø±ÙƒØ©</option>
            </select>
          </div>
          <div class="step">
            <label>Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„</label>
            <select id="modelSelect" disabled>
              <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MAIN CONTENT -->
  <div class="container">
    <div class="results-header" id="resultsHeader" style="display: none;">
      <div class="results-count" id="resultsCount"></div>
      <select class="sort-select" id="sortSelect">
        <option value="default">Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</option>
        <option value="price-low">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø£Ø¹Ù„Ù‰</option>
        <option value="price-high">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø£Ù‚Ù„</option>
        <option value="name">Ø§Ù„Ø§Ø³Ù…: Ø£ - ÙŠ</option>
      </select>
    </div>

    <div class="products-grid" id="productsGrid"></div>
  </div>

  <!-- CART PANEL -->
  <div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>
  <div class="cart-panel" id="cartPanel">
    <div class="cart-header">
      <h2>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h2>
      <button class="cart-close" onclick="toggleCart()">Ã—</button>
    </div>
    <div class="cart-items" id="cartItems"></div>
    <div class="cart-footer">
      <div class="cart-total">
        <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</span>
        <span id="cartTotal">0 Ø¯Ø¬</span>
      </div>
      <button class="btn btn-whatsapp" onclick="orderAllOnWhatsApp()" style="width: 100%;">
        Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
      </button>
    </div>
  </div>

  <script>
    let carsData = {};

    let cart = [];
    let currentBrand = '';
    let currentModel = '';

    // Initialize
    const brandSelect = document.getElementById('brandSelect');
    const modelSelect = document.getElementById('modelSelect');
    const productsGrid = document.getElementById('productsGrid');
    const sortSelect = document.getElementById('sortSelect');

    // Load data from external JSON and populate brands
    async function loadData() {
      try {
        const response = await fetch('cars_data.json');
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        carsData = await response.json();
        populateBrands();
      } catch (error) {
        console.error('Failed to load cars_data.json', error);
        alert('ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠÙÙ†ØµØ­ Ø¨ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ø¹Ø¨Ø± Ø®Ø§Ø¯Ù… Ù…Ø­Ù„ÙŠ (Ù…Ø«Ù„ Live Server).');
      }
    }

    function populateBrands() {
      brandSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ø±ÙƒØ©</option>';
      Object.keys(carsData).forEach(brand => {
        const option = document.createElement('option');
        option.value = brand;
        option.textContent = brand;
        brandSelect.appendChild(option);
      });
    }

    loadData();

    brandSelect.addEventListener('change', function() {
      const selectedBrand = this.value;
      currentBrand = selectedBrand;
      modelSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„</option>';
      productsGrid.innerHTML = '';
      document.getElementById('resultsHeader').style.display = 'none';

      if (selectedBrand) {
        modelSelect.disabled = false;
        const models = carsData[selectedBrand].models;
        Object.keys(models).forEach(model => {
          const option = document.createElement('option');
          option.value = model;
          option.textContent = model;
          modelSelect.appendChild(option);
        });
      } else {
        modelSelect.disabled = true;
        currentBrand = '';
        currentModel = '';
      }
    });

    modelSelect.addEventListener('change', function() {
      const selectedModel = this.value;
      currentModel = selectedModel;

      if (currentBrand && selectedModel) {
        const parts = (carsData[currentBrand]?.models?.[selectedModel]?.parts) || [];
        displayProducts(parts);
      } else {
        productsGrid.innerHTML = '';
        document.getElementById('resultsHeader').style.display = 'none';
      }
    });

    sortSelect.addEventListener('change', function() {
      if (currentBrand && currentModel) {
        const parts = [...(carsData[currentBrand]?.models?.[currentModel]?.parts || [])];
        const sortedParts = sortProducts(parts, this.value);
        displayProducts(sortedParts);
      }
    });

    function sortProducts(parts, sortType) {
      const sorted = [...parts];
      switch(sortType) {
        case 'price-low':
          return sorted.sort((a, b) => a.price - b.price);
        case 'price-high':
          return sorted.sort((a, b) => b.price - a.price);
        case 'name':
          return sorted.sort((a, b) => a.name.localeCompare(b.name, 'ar'));
        default:
          return sorted;
      }
    }

    function displayProducts(parts) {
      if (parts.length === 0) {
        productsGrid.innerHTML = `
          <div class="empty-state" style="grid-column: 1/-1;">
            <h2>Ù„Ù… Ù†Ø¬Ø¯ Ø£ÙŠ Ù‚Ø·Ø¹ Ù…ØªØ§Ø­Ø©</h2>
            <p>Ø¬Ø±Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ø³ÙŠØ§Ø±Ø© Ø£Ø®Ø±Ù‰ Ø£Ùˆ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©</p>
          </div>
        `;
        document.getElementById('resultsHeader').style.display = 'none';
        return;
      }

      document.getElementById('resultsHeader').style.display = 'flex';
      document.getElementById('resultsCount').textContent = `${parts.length} Ù‚Ø·Ø¹Ø© Ù…ØªÙˆÙØ±Ø©`;

      productsGrid.innerHTML = '';
      parts.forEach((part, index) => {
        const card = document.createElement('div');
        card.className = 'product-card';
        
        const badgeHTML = part.badge ? `
          <div class="product-badge ${part.badge === 'bestseller' ? 'bestseller' : ''}">
            ${part.badge === 'bestseller' ? 'â­ Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹' : 'ğŸ”¥ Ø¹Ø±Ø¶ Ø®Ø§Øµ'}
          </div>
        ` : '';

        const ratingValue = Number(part.rating) || 0;
        const reviewsValue = part.reviews ?? 0;
        const starsHTML = 'â˜…'.repeat(Math.floor(ratingValue)) + 'â˜†'.repeat(5 - Math.floor(ratingValue));
        const refHTML = part.ref ? `<div class="product-ref">Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹: ${part.ref}</div>` : '';

        card.innerHTML = `
          ${badgeHTML}
          <div class="product-image-container">
            <div class="image-slider-wrapper" id="slider-${index}">
              ${part.images.map(img => `
                <img src="${img}" alt="${part.name}" 
                     onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 400 300%22%3E%3Crect fill=%22%23f0f0f0%22 width=%22400%22 height=%22300%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22sans-serif%22 font-size=%2218%22 fill=%22%23999%22%3E${encodeURIComponent(part.name)}%3C/text%3E%3C/svg%3E'">
              `).join('')}
            </div>
            <div class="slider-controls">
              ${part.images.map((_, i) => `
                <span class="slider-dot ${i === 0 ? 'active' : ''}" 
                      onclick="changeImage(${index}, ${i})"></span>
              `).join('')}
            </div>
          </div>
          <div class="product-info">
            <div class="product-name">${part.name}</div>
            ${refHTML}
            <div class="product-rating">
              <span class="stars">${starsHTML}</span>
              <span>(${reviewsValue})</span>
            </div>
            <div class="product-price">
              ${part.price.toLocaleString()} <span class="price-currency">Ø¯Ø¬</span>
            </div>
            <div class="product-actions">
              <button class="btn btn-primary" onclick="addToCart(${index})">
                ğŸ›’ Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©
              </button>
              <button class="btn btn-whatsapp" onclick="orderOnWhatsApp('${part.name}', ${part.price})">
                ğŸ’¬
              </button>
            </div>
          </div>
        `;
        productsGrid.appendChild(card);
      });
    }

    function changeImage(productIndex, imageIndex) {
      const slider = document.getElementById(`slider-${productIndex}`);
      slider.style.transform = `translateX(${imageIndex * 100}%)`;
      
      const dots = slider.parentElement.querySelectorAll('.slider-dot');
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === imageIndex);
      });
    }

    function addToCart(productIndex) {
      const parts = (carsData[currentBrand]?.models?.[currentModel]?.parts) || [];
      const part = parts[productIndex];
      if (!part) return;

      const existingItem = cart.find(item => item.ref === part.ref);
      if (existingItem) {
        existingItem.quantity++;
      } else {
        cart.push({
          ...part,
          brand: currentBrand,
          model: currentModel,
          quantity: 1
        });
      }
      
      updateCart();
      
      // Animation feedback
      const btn = event.target;
      const originalText = btn.innerHTML;
      btn.innerHTML = 'âœ“ ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©';
      btn.style.background = '#27ae60';
      setTimeout(() => {
        btn.innerHTML = originalText;
        btn.style.background = '';
      }, 1500);
    }

    function updateCart() {
      const cartCount = document.getElementById('cartCount');
      const cartItems = document.getElementById('cartItems');
      const cartTotal = document.getElementById('cartTotal');
      
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      
      cartCount.textContent = totalItems;
      cartTotal.textContent = `${totalPrice.toLocaleString()} Ø¯Ø¬`;
      
      if (cart.length === 0) {
        cartItems.innerHTML = `
          <div style="text-align: center; padding: 40px 20px; color: #7f8c8d;">
            <div style="font-size: 3em; margin-bottom: 10px;">ğŸ›’</div>
            <p>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</p>
          </div>
        `;
      } else {
        cartItems.innerHTML = cart.map((item, index) => `
          <div class="cart-item">
            <img src="${item.images[0]}" alt="${item.name}" class="cart-item-image"
                 onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 70 70%22%3E%3Crect fill=%22%23f0f0f0%22 width=%2270%22 height=%2270%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-size=%2210%22 fill=%22%23999%22%3EğŸ“¦%3C/text%3E%3C/svg%3E'">
            <div class="cart-item-info">
              <div class="cart-item-name">${item.name}</div>
              <div style="font-size: 0.85em; color: #7f8c8d; margin-bottom: 5px;">
                ${item.brand} ${item.model} â€¢ Ø§Ù„ÙƒÙ…ÙŠØ©: ${item.quantity}
              </div>
              <div class="cart-item-price">${(item.price * item.quantity).toLocaleString()} Ø¯Ø¬</div>
            </div>
            <button class="cart-item-remove" onclick="removeFromCart(${index})">Ã—</button>
          </div>
        `).join('');
      }
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      updateCart();
    }

    function toggleCart() {
      const panel = document.getElementById('cartPanel');
      const overlay = document.getElementById('cartOverlay');
      panel.classList.toggle('open');
      overlay.classList.toggle('open');
    }

    function orderOnWhatsApp(partName, price) {
      const phoneNumber = '213XXXXXXXXX'; // Ø¶Ø¹ Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ù‡Ù†Ø§
      const message = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ğŸ‘‹

ğŸš— Ø§Ù„Ø³ÙŠØ§Ø±Ø©: ${currentBrand} ${currentModel}
ğŸ”§ Ø§Ù„Ù‚Ø·Ø¹Ø©: ${partName}
ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${price.toLocaleString()} Ø¯Ø¬

Ø£Ø±ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø·Ø¹Ø©`;
      
      const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
      window.open(url, '_blank');
    }

    function orderAllOnWhatsApp() {
      if (cart.length === 0) {
        alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©! Ø£Ø¶Ù Ù‚Ø·Ø¹ Ø£ÙˆÙ„Ø§Ù‹');
        return;
      }
      
      const phoneNumber = '213XXXXXXXXX'; // Ø¶Ø¹ Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ù‡Ù†Ø§
      const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      
      let message = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ğŸ‘‹

ğŸ“‹ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

`;
      
      cart.forEach((item, index) => {
        message += `${index + 1}. ${item.name}
   ğŸš— ${item.brand} ${item.model}
   ğŸ“¦ Ø§Ù„ÙƒÙ…ÙŠØ©: ${item.quantity}
   ğŸ’° ${(item.price * item.quantity).toLocaleString()} Ø¯Ø¬

`;
      });
      
      message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’µ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total.toLocaleString()} Ø¯Ø¬

Ø£Ø±ÙŠØ¯ ØªØ£ÙƒÙŠØ¯ Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† ÙØ¶Ù„Ùƒ`;
      
      const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
      window.open(url, '_blank');
    }

    // Close cart when clicking outside
    document.addEventListener('click', function(e) {
      const panel = document.getElementById('cartPanel');
      const cartBtn = document.querySelector('.cart-btn');
      
      if (panel.classList.contains('open') && 
          !panel.contains(e.target) && 
          !cartBtn.contains(e.target)) {
        toggleCart();
      }
    });
  </script>
</body>
</html>